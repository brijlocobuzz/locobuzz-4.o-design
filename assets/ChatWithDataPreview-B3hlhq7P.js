import{r as m,j as e,P as $,b as M,h as b,i as E,k as I,l as j,m as T,A as k,L as Q,n as R}from"./index-DqtLnMh1.js";import{M as v}from"./message-square-DbZmWq9p.js";import{I as U}from"./inbox-Cq2FJxy8.js";import{C as A}from"./chart-column-C6TMB1aU.js";import{M as B}from"./minus-BczsAUEQ.js";import{T as q}from"./trending-up-oSIESFBK.js";import{U as V}from"./user-AEg5BI1F.js";import{S as F}from"./send-DmfBfJHb.js";function K({conversations:t,activeConversationId:s,onSelectConversation:a,onCreateConversation:l,onSearchConversations:r}){const[i,o]=m.useState(""),d=n=>{o(n),r?.(n)},c=i?t.filter(n=>n.title.toLowerCase().includes(i.toLowerCase())||n.preview.toLowerCase().includes(i.toLowerCase())):t;return e.jsxs("div",{className:"flex h-full w-64 flex-col border-r border-slate-200 bg-white dark:border-slate-800 dark:bg-slate-900",children:[e.jsx("div",{className:"border-b border-slate-200 p-4 dark:border-slate-800",children:e.jsxs("button",{onClick:l,className:"flex w-full items-center justify-center gap-2 rounded-lg bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white hover:bg-indigo-700 dark:bg-indigo-500 dark:hover:bg-indigo-600",children:[e.jsx($,{className:"h-4 w-4"}),"New Conversation"]})}),e.jsx("div",{className:"border-b border-slate-200 p-4 dark:border-slate-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",value:i,onChange:n=>d(n.target.value),className:"w-full rounded-lg border border-slate-200 bg-white py-2 pl-9 pr-3 text-sm text-slate-900 placeholder-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:placeholder-slate-500"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(v,{className:"h-12 w-12 text-slate-300 dark:text-slate-600"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400",children:i?"No conversations found":"No conversations yet"})]}):e.jsx("div",{className:"space-y-1",children:c.map(n=>{const x=n.id===s;return e.jsxs("button",{onClick:()=>a?.(n.id),className:`group w-full rounded-lg p-3 text-left transition-colors ${x?"bg-indigo-50 dark:bg-indigo-950/50":"hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:`line-clamp-1 text-sm font-medium ${x?"text-indigo-900 dark:text-indigo-100":"text-slate-900 dark:text-white"}`,children:n.title}),e.jsx("span",{className:`text-xs ${x?"text-indigo-600 dark:text-indigo-400":"text-slate-400 dark:text-slate-500"}`,children:n.messageCount})]}),e.jsx("p",{className:`mt-1 line-clamp-2 text-xs ${x?"text-indigo-700 dark:text-indigo-300":"text-slate-500 dark:text-slate-400"}`,children:n.preview}),e.jsx("p",{className:`mt-1.5 text-xs ${x?"text-indigo-600 dark:text-indigo-400":"text-slate-400 dark:text-slate-500"}`,children:new Date(n.updatedAt).toLocaleDateString("en-US",{month:"short",day:"numeric"})})]},n.id)})})})]})}function O({currentBrand:t,availableBrands:s,conversationTitle:a,onBrandChange:l}){const[r,i]=m.useState(!1),o=m.useRef(null);return m.useEffect(()=>{const d=c=>{o.current&&!o.current.contains(c.target)&&i(!1)};return r&&document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[r]),e.jsx("div",{className:"border-b border-slate-200 bg-white px-6 py-4 dark:border-slate-800 dark:bg-slate-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"relative",ref:o,children:[e.jsxs("button",{onClick:()=>i(!r),className:"flex items-center gap-2 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:hover:bg-slate-700",children:[e.jsx(b,{className:"h-4 w-4 text-slate-500 dark:text-slate-400"}),e.jsx("span",{children:t.name}),e.jsx(E,{className:`h-4 w-4 text-slate-400 transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsx("div",{className:"absolute left-0 top-full z-50 mt-2 w-64 rounded-lg border border-slate-200 bg-white py-1 shadow-lg dark:border-slate-700 dark:bg-slate-800",children:s.map(d=>e.jsxs("button",{onClick:()=>{l?.(d.id),i(!1)},className:`flex w-full items-center gap-2 px-4 py-2 text-left text-sm hover:bg-slate-50 dark:hover:bg-slate-700 ${d.id===t.id?"bg-indigo-50 text-indigo-900 dark:bg-indigo-950/50 dark:text-indigo-100":"text-slate-700 dark:text-slate-300"}`,children:[e.jsx(b,{className:"h-4 w-4 text-slate-400"}),d.name]},d.id))})]}),a&&e.jsx("h1",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:a})]})})}const W={MessageSquare:v,FileText:I,BarChart3:A,Inbox:U};function z({categories:t,onSelectCategory:s}){return e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-4xl text-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:"What would you like to explore?"}),e.jsx("p",{className:"mt-2 text-sm text-slate-500 dark:text-slate-400",children:"Choose a data category to get started with AI-powered insights"}),e.jsx("div",{className:"mt-8 grid grid-cols-1 gap-4 sm:grid-cols-2",children:t.map(a=>{const l=W[a.icon];return e.jsxs("button",{onClick:()=>s?.(a.id),className:"group flex flex-col items-start gap-3 rounded-xl border border-slate-200 bg-white p-6 text-left transition-all hover:border-indigo-300 hover:shadow-md dark:border-slate-700 dark:bg-slate-800 dark:hover:border-indigo-600",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-indigo-100 text-indigo-600 transition-colors group-hover:bg-indigo-600 group-hover:text-white dark:bg-indigo-950 dark:text-indigo-400 dark:group-hover:bg-indigo-600 dark:group-hover:text-white",children:e.jsx(l,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:a.name}),e.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:a.description})]})]},a.id)})})]})})}function p({questions:t,onSelectQuestion:s}){return e.jsxs("div",{className:"border-b border-slate-200 bg-slate-50 px-6 py-4 dark:border-slate-800 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Starter questions:"})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.map((a,l)=>e.jsx("button",{onClick:()=>s?.(a),className:"inline-flex items-center rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm text-slate-700 transition-colors hover:border-indigo-300 hover:bg-indigo-50 hover:text-indigo-700 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:border-indigo-600 dark:hover:bg-indigo-950/50 dark:hover:text-indigo-300",children:a},l))})]})}const H={up:q,down:T,neutral:B},P={up:"text-green-600 dark:text-green-400",down:"text-red-600 dark:text-red-400",neutral:"text-slate-400 dark:text-slate-500"};function _({kpis:t}){return e.jsx("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-3",children:t.map((s,a)=>{const l=s.trend?H[s.trend]:null,r=s.trend?P[s.trend]:"";return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4 dark:border-slate-700 dark:bg-slate-800",children:[e.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400",children:s.label}),e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsx("p",{className:"text-2xl font-semibold text-slate-900 dark:text-white",children:s.value}),l&&s.trendValue&&e.jsxs("div",{className:`flex items-center gap-1 text-sm ${r}`,children:[e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{children:s.trendValue})]})]}),e.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:s.subtitle})]},a)})})}function G({id:t,chartType:s,title:a,data:l,deepDiveEnabled:r,onDeepDive:i}){const o=Math.max(...l.datasets.flatMap(d=>d.values));return e.jsxs("div",{className:"rounded-lg border border-slate-200 bg-white p-4 dark:border-slate-700 dark:bg-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-white",children:a}),r&&e.jsxs("button",{onClick:()=>i?.(t),className:"flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-700 dark:text-indigo-400 dark:hover:text-indigo-300",children:["Deep Dive",e.jsx(k,{className:"h-4 w-4"})]})]}),s==="line"&&e.jsxs("div",{className:"mt-4 space-y-4",children:[l.datasets.map((d,c)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:u(d.color)}}),e.jsx("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:d.label})]}),e.jsx("div",{className:"flex items-end gap-1",style:{height:"80px"},children:d.values.map((n,x)=>e.jsx("div",{className:"flex flex-1 flex-col items-center gap-1",children:e.jsx("div",{className:"w-full rounded-t",style:{height:`${n/o*100}%`,backgroundColor:u(d.color),opacity:.7}})},x))})]},c)),e.jsx("div",{className:"flex justify-between text-xs text-slate-500 dark:text-slate-400",children:l.labels.map((d,c)=>e.jsx("span",{children:d},c))})]}),s==="bar"&&e.jsx("div",{className:"mt-4 space-y-2",children:l.labels.map((d,c)=>{const n=l.datasets[0]?.values[c]||0,x=n/o*100;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:d}),e.jsx("span",{className:"font-medium text-slate-900 dark:text-white",children:n.toLocaleString()})]}),e.jsx("div",{className:"h-2 w-full rounded-full bg-slate-100 dark:bg-slate-700",children:e.jsx("div",{className:"h-full rounded-full",style:{width:`${x}%`,backgroundColor:u(l.datasets[0]?.color||"indigo")}})})]},c)})})]})}function u(t){return{indigo:"#4f46e5",green:"#16a34a",red:"#dc2626",gray:"#6b7280",blue:"#2563eb"}[t]||t}function J({id:t,title:s,columns:a,rows:l,deepDiveEnabled:r,onDeepDive:i}){return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-slate-200 bg-white dark:border-slate-700 dark:bg-slate-800",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-slate-200 px-4 py-3 dark:border-slate-700",children:[e.jsx("h4",{className:"font-medium text-slate-900 dark:text-white",children:s}),r&&e.jsxs("button",{onClick:()=>i?.(t),className:"flex items-center gap-1 text-sm text-indigo-600 hover:text-indigo-700 dark:text-indigo-400 dark:hover:text-indigo-300",children:["Deep Dive",e.jsx(k,{className:"h-4 w-4"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900",children:e.jsx("tr",{children:a.map((o,d)=>e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wide text-slate-500 dark:text-slate-400",children:o},d))})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:l.map((o,d)=>e.jsx("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:o.map((c,n)=>e.jsx("td",{className:"px-4 py-3 text-sm text-slate-700 dark:text-slate-300",children:c},n))},d))})]})})]})}function X({component:t,onDeepDive:s}){switch(t.type){case"text":return e.jsx("div",{className:"prose prose-sm max-w-none dark:prose-invert",dangerouslySetInnerHTML:{__html:t.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\n/g,"<br />")}});case"kpi-row":return e.jsx(_,{kpis:t.kpis});case"chart":return e.jsx(G,{id:t.id,chartType:t.chartType,title:t.title,data:t.data,deepDiveEnabled:t.deepDiveEnabled,onDeepDive:s});case"table":return e.jsx(J,{id:t.id,title:t.title,columns:t.columns,rows:t.rows,deepDiveEnabled:t.deepDiveEnabled,onDeepDive:s});default:return null}}function Y({messages:t,onDeepDive:s}){return e.jsx("div",{className:"flex-1 space-y-6 overflow-y-auto px-6 py-4",children:t.map(a=>a.type==="user"?e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex max-w-2xl items-start gap-3",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"rounded-lg bg-indigo-600 px-4 py-2.5 text-white dark:bg-indigo-500",children:e.jsx("p",{className:"text-sm",children:a.content})}),e.jsx("p",{className:"text-right text-xs text-slate-400 dark:text-slate-500",children:new Date(a.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]}),e.jsx("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full bg-indigo-100 dark:bg-indigo-950",children:e.jsx(V,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-400"})})]})},a.id):e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"flex max-w-4xl items-start gap-3",children:[e.jsx("div",{className:"flex h-8 w-8 flex-shrink-0 items-center justify-center rounded-full bg-sky-100 dark:bg-sky-950",children:e.jsx(j,{className:"h-4 w-4 text-sky-600 dark:text-sky-400"})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[a.components.map((l,r)=>e.jsx(X,{component:l,onDeepDive:()=>s?.(`${a.id}-${r}`)},r)),e.jsx("p",{className:"text-xs text-slate-400 dark:text-slate-500",children:new Date(a.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})]})},a.id))})}function f({isProcessing:t,onSendMessage:s}){const[a,l]=m.useState(""),r=i=>{i.preventDefault(),a.trim()&&!t&&(s?.(a),l(""))};return e.jsxs("div",{className:"border-t border-slate-200 bg-white px-6 py-4 dark:border-slate-800 dark:bg-slate-900",children:[e.jsxs("form",{onSubmit:r,className:"flex items-end gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("textarea",{value:a,onChange:i=>l(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),r(i))},placeholder:"Ask a question about your data...",disabled:t,rows:1,className:"w-full resize-none rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm text-slate-900 placeholder-slate-400 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-700 dark:bg-slate-800 dark:text-white dark:placeholder-slate-500"})}),e.jsx("button",{type:"submit",disabled:!a.trim()||t,className:"flex h-10 w-10 items-center justify-center rounded-lg bg-indigo-600 text-white transition-colors hover:bg-indigo-700 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-indigo-500 dark:hover:bg-indigo-600",children:e.jsx(F,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"mt-2 text-xs text-slate-500 dark:text-slate-400",children:"Press Enter to send, Shift+Enter for new line"})]})}function Z({steps:t,currentStep:s}){const a=t[s-1];return e.jsxs("div",{className:"flex items-start gap-3 rounded-lg bg-slate-50 p-4 dark:bg-slate-800/50",children:[e.jsx(Q,{className:"h-5 w-5 animate-spin text-indigo-600 dark:text-indigo-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:a?.label||"Processing..."}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:t.map(l=>e.jsx("div",{className:`h-1 flex-1 rounded-full ${l.step<=s?"bg-indigo-600 dark:bg-indigo-500":"bg-slate-200 dark:bg-slate-700"}`},l.step))}),e.jsxs("p",{className:"mt-1.5 text-xs text-slate-500 dark:text-slate-400",children:["Step ",s," of ",t.length]})]})]})}function ee({currentBrand:t,availableBrands:s,conversations:a,dataCategories:l,activeConversation:r,processingSteps:i,isProcessing:o=!1,onBrandChange:d,onSelectConversation:c,onCreateConversation:n,onSelectCategory:x,onSendMessage:h,onDeepDive:N,onSearchConversations:w}){const[y]=m.useState(1),g=r?l.find(L=>L.id===r.category):null,C=!r,S=r&&r.messages.length===0&&g,D=r&&(r.messages.length>0||o);return e.jsxs("div",{className:"flex h-full bg-slate-50 dark:bg-slate-950",children:[e.jsx(K,{conversations:a,activeConversationId:r?.id,onSelectConversation:c,onCreateConversation:n,onSearchConversations:w}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx(O,{currentBrand:t,availableBrands:s,conversationTitle:r?.title,onBrandChange:d}),C&&e.jsx(z,{categories:l,onSelectCategory:x}),S&&e.jsxs(e.Fragment,{children:[e.jsx(p,{questions:g.starterQuestions,onSelectQuestion:h}),e.jsx("div",{className:"flex flex-1 items-center justify-center",children:e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Select a starter question or type your own below"})}),e.jsx(f,{isProcessing:o,onSendMessage:h})]}),D&&e.jsxs(e.Fragment,{children:[g&&r.messages.length===0&&e.jsx(p,{questions:g.starterQuestions,onSelectQuestion:h}),e.jsx(Y,{messages:r.messages,onDeepDive:N}),o&&e.jsx("div",{className:"px-6 pb-4",children:e.jsx(Z,{steps:i,currentStep:y})}),e.jsx(f,{isProcessing:o,onSendMessage:h})]})]})]})}function oe(){const t=R;return e.jsx(ee,{currentUser:t.currentUser,currentBrand:t.currentBrand,availableBrands:t.availableBrands,conversations:t.conversations,dataCategories:t.dataCategories,activeConversation:t.activeConversation,processingSteps:t.processingSteps,isProcessing:!1,onBrandChange:s=>console.log("Brand changed:",s),onSelectConversation:s=>console.log("Conversation selected:",s),onCreateConversation:()=>console.log("Create new conversation"),onSelectCategory:s=>console.log("Category selected:",s),onSendMessage:s=>console.log("Message sent:",s),onDeepDive:s=>console.log("Deep dive:",s),onSearchConversations:s=>console.log("Search:",s)})}export{oe as default};
